!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.Aoy=e.Aoy||{})}(this,function(e){"use strict";function n(e){"undeifine"!=typeof console&&console.error(e)}function t(e){"undeifine"!=typeof console&&console.warn(e)}function r(e){return Object.prototype.toString.call(e)}function i(e){return"[object Array]"===r(e)}function o(e){return"[object Object]"===r(e)}function l(e){return"string"==typeof e}function u(e){return"number"==typeof e}function f(e){return[].slice.call(e)}function a(){this.tagName=null,this.sel=null,this.id=null,this.className=[],this.children=null,this.el=null,this.data=null,this.key=null,this.text=null,this.attr=[],this.store=null}function s(e,n){return n.key===e.key&&n.sel===e.sel}function c(e,n,t){var r,i,o,l={};for(r=n;r<=t;++r)null!=(o=e[r])&&null!==(i=o.key)&&(l[i]=r);return l}function d(e,n,t,r){for(;t<=r;++t){var i=n[t];null!=i&&D.removeChild(e,i.el)}}function h(e,n,t,r,i){for(;r<=i;++r){var o=t[r];null!=o&&D.insertBefore(e,N(o).el,n)}}function p(e,n){var t=n.el=e.el,r=e.children,i=n.children;e!==n&&(e.text&&n.text&&e.text!==n.text?D.setTextContent(t,n.text):(_(t,n,e),r&&i&&r!==i?v(t,r,i):i?N(n):r&&D.removeChildren(t)))}function v(e,n,t){for(var r,i,o,l,u=0,f=0,a=n.length-1,v=n[0],y=n[a],g=t.length-1,m=t[0],b=t[g];u<=a&&f<=g;)null==v?v=n[++u]:null==y?y=n[--a]:null==m?m=t[++f]:null==b?b=t[--g]:s(v,m)?(p(v,m),v=n[++u],m=t[++f]):s(y,b)?(p(y,b),y=n[--a],b=t[--g]):s(v,b)?(p(v,b),D.insertBefore(e,v.el,D.nextSibling(y.el)),v=n[++u],b=t[--g]):s(y,m)?(p(y,m),D.insertBefore(e,y.el,v.el),y=n[--a],m=t[++f]):(void 0===r&&(r=c(n,u,a)),i=r[m.key],i?(o=n[i],o.sel!==m.sel?D.insertBefore(e,N(m).el,v.el):(p(o,m),n[i]=null,D.insertBefore(e,o.el,v.el)),m=t[++f]):(D.insertBefore(e,N(m).el,v.el),m=t[++f]));u>a?(l=null==t[g+1]?null:t[g+1].el,h(e,l,t,f,g)):f>g&&d(e,n,u,a)}function y(e,n){if(s(e,n))p(e,n);else{var t=e.el,r=D.parentNode(t);N(n),null!==r&&(D.insertBefore(r,n.el,D.nextSibling(t)),D.removeChild(r,e.el),e=null)}return n}function g(e,n){var t,r=0,i=0;e.sel=n;for(var o=0,l=n.length;o<l;o++){var u=n[o];("."===u||"#"===u||(t=o===l-1))&&(0===r?e.tagName=n.substring(i,t?l:o).toUpperCase():1===r?e.className.push(n.substring(i,t?l:o)):2===r&&(e.id=n.substring(i,t?l:o)),r="."===u?1:"#"===u?2:3,i=o+1)}}function m(e,n){for(var t in n)if("class"===t)for(var r=n[t].split(" "),i=0;i<r.length;i++)e.className.push(r[i]);else"key"===t?e.key=n[t]:"style"!==t&&e.attr.push(t);e.data=n}function b(e,n){var t=[];(l(n)||u(n))&&(n=[n]);for(var r=0;r<n.length;r++)n[r]instanceof a?t.push(n[r]):t.push(x(n[r]));e.children=t}function x(e){var n=new a;return(l(e)||u(e))&&(n.text=e),n}function C(e){for(var n=0,t=new a;n<e.length;){var r=e[n];0===n&&l(r)?g(t,r):0!=n&&(o(r)?m(t,r):(i(r)||l(r)||u(r))&&b(t,r)),n++}return t}function N(e){var n,t;return!e.el&&(n=e.text)?(t=e.el=D.createTextNode(n),e):((n=e.tagName)&&null===e.el?t=e.el=D.createElement(n):1===e.el.nodeType&&(t=e.el),_(t,e),e)}function _(e,n,t){var r;(r=n.className).length>0&&D.setClass(e,r),null!==(r=n.data)&&D.setAttrs(e,r),null!==(r=n.id)&&D.setId(e,r),null===(r=n.children)||t||D.appendChildren(e,r)}function P(){var e=f(arguments);return 0===e.length?(n("Parameter cannot be empty"),!1):i(e)&&e.length>0?C.call(this,e):void 0}function j(e,n,t,r){var i;if(o(t)){e[n]=t,i=new A(t,n,r);for(var l in t)i(l)}return t}function A(e,t,r){var i,l={},u=r.componentManage,f=function(e){e.forEach(function(e,n){var t=e.render();y(e.vdom,t),e.vdom=t})},a=function(e){return{get:function(){return l[e]},set:function(n){l[e]=n,(i=u[t])&&f(i)}}};return D.defineProperty(e,"set",{value:function(){var r;if(o(r=arguments[0])){for(var s in r)l.hasOwnProperty(s)||D.defineProperty(e,s,a(s)),l[s]=r[s];(i=u[t])&&f(i)}else n("set function's parameter must be a object")}}),function(n){l[n]=e[n],D.defineProperty(e,n,a(n))}}function O(){var e=new T;return this instanceof I&&!this._FINALSTORE?(Object.defineProperty(this,"store",{set:function(e){t("Not allowed to modify store")},get:function(){return e}}),Object.defineProperty(this,"_FINALSTORE",{value:!0})):t("Not Aoy instance or Already init store"),this}function T(){var e={};this.componentManage={},this.add=function(){var t,r=f(arguments);if(r.length>0){var i=l(r[0]),u=o(r[1]),a=o(r[0]);i&&u?t=j(e,r[0],r[1],this):a?t=j(e,"_DEFAULT",r[0],this):n("Missing key or data parameter")}return t},this.get=function(n){return void 0===n&&(n="_DEFAULT"),e[n]},this.getMainStore=function(){return e},this.remove=function(n){void 0===n&&(n="_DEFAULT"),delete e[n]}}function S(e){var n,t=this,r=F++;return function(){return o(e)&&(n=new w(e),D.defineProperty(n,"aoy",{value:t}),D.defineProperty(n,"_UID",{value:r})),n}()}function w(e){var n=this;if(o(e))for(var t in e)n[t]=e[t]}function B(e,n){var t=this.store,r=t.componentManage,o=t.get,u=e._UID,f=this,a=function(n,t){r[t]?r[t].push(e):r[t]=[e],f._dependent(u,t),D.defineProperty(n,t,{get:function(){return o(t)}})};if(e instanceof w){if(l(n))a(e,n);else if(i(n))for(var s=0;s<n.length;s++)a(e,n[s]);this.mount(e.el,e)}}function E(e,n){var t=this.dependManage[e];t&&t.length>0?t.push(n):this.dependManage[e]=[n]}function M(e,n){var t=n.render(),r=N(t);n.vdom=t,D.appendChild(e,r.el)}function k(e){e.prototype._init=function(e){this.dependManage=Object.create(null),this._initStore()},e.prototype._initStore=O,e.prototype.createComponent=S,e.prototype.connect=B,e.prototype._dependent=E,e.prototype.mount=M,e.prototype.el=P,e.prototype.patch=y}function I(){this instanceof I&&this._init()}function U(){return k(I),new I}var D=Object.create(null);D.createElement=function(e){return document.createElement(e)},D.createTextNode=function(e){return document.createTextNode(e)},D.appendChild=function(e,n){return e.appendChild(n)},D.parentNode=function(e){return e.parentNode},D.insertBefore=function(e,n,t){return e.insertBefore(n,t)},D.nextSibling=function(e){return e.nextSibling},D.removeChild=function(e,n){return e.removeChild(n)},D.setTextContent=function(e,n){e.textContent=n},D.setId=function(e,n){e.id=n},D.defineProperty=function(e,n,t){Object.defineProperty(e,n,t)},D.appendChildren=function(e,n){var t=this;if(e&&i(n))for(var r=0;r<n.length;r++){var o=void 0;n[r]instanceof a&&(o=n[r].el||N(n[r]).el),t.appendChild(e,o)}},D.setClass=function(e,n){if(e&&i(n)){for(var t="",r=0;r<n.length;r++)t+=r!==n.length-1?n[r]+" ":n[r];e.className=t}},D.setAttrs=function(e,n){if(e&&o(n))for(var t in n)if("class"!==t){var r=n[t];if("style"===t&&o(r))for(var i in r)e.style[i]=r[i];else e[t]=r}},D.removeChildren=function(e){for(var n=this,t=e.childNodes;t[0];)n.removeChild(e,t[0])};var F=0;e.init=U,Object.defineProperty(e,"__esModule",{value:!0})});